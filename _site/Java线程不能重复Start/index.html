<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Java线程为什么不能重复调用start() &#8211; Maple Story</title> <meta name="description" content="Stick to note down what I’v learnt"> <meta name="keywords" content="Java"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="halve.png"> <meta name="twitter:title" content="Java线程为什么不能重复调用start()"> <meta name="twitter:description" content="Stick to note down what I’v learnt"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Java线程为什么不能重复调用start()"> <meta property="og:description" content="Stick to note down what I’v learnt"> <meta property="og:url" content="http://localhost:4000/Java%E7%BA%BF%E7%A8%8B%E4%B8%8D%E8%83%BD%E9%87%8D%E5%A4%8DStart/"> <meta property="og:site_name" content="Maple Story"> <meta property="og:image" content="http://localhost:4000/images/halve.png"> <link rel="canonical" href="http://localhost:4000/Java%E7%BA%BF%E7%A8%8B%E4%B8%8D%E8%83%BD%E9%87%8D%E5%A4%8DStart/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/home.jpg) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="http://localhost:4000" class="logo"><img src="http://localhost:4000/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Java线程为什么不能重复调用start() </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#Java">Java</a></li> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">06 Aug 2020</div> <center><h2><b>Java线程不能重复调用start()</b></h2></center> <p><br /></p> <h3 id="线程的状态">线程的状态</h3> <ul> <li> <p>NEW</p> <p>线程被创建，但是还没有调用start方法。</p> </li> <li> <p>RUNNABLE</p> <p>线程正在运行或者，在<strong>就绪队列</strong>当中等待OS分配CPU片段。</p> </li> <li> <p>BLOCKED</p> <p>阻塞状态，等待获得锁。例如，线程试图通过synchronized去获取某个锁，但是其他线程已经独占了，那么当前线程就会处于阻塞状态。</p> </li> <li> <p>WAITING</p> <p>等待。线程调用对象的wait方法，或者Thread的join方法而没有运行。例如生产者消费者模式下，需要调用wait()等待生产者线程notify()。</p> </li> <li> <p>TIMED_WAITING</p> <p>计时等待，其进入条件和等待状态类似，但是调用的是存在超时条件的方法，比如wait或join等方法的指定超时版本，比如调用sleep方法。</p> </li> <li> <p>TERMINATED</p> <p>结束状态。</p> </li> </ul> <p><a href="https://blog.csdn.net/qq_22771739/article/details/82529874">Java线程的6种状态及切换(透彻讲解)</a></p> <blockquote> <p>sleep方法，暂停当前线程，把cpu片段让出给其他线程，减缓当前线程的执行。</p> <p>但是如果当前线程占有了锁，线程不会释放锁。</p> <p>sleep过后，不是直接到了运行状态，而是到就绪（可运行）状态。</p> </blockquote> <h3 id="为什么不能重复调用start">为什么不能重复调用start()</h3> <p>同一个线程对象不能重复调用start()。</p> <p>调用一次start()之后进入可运行状态，当我们再次调用start方法的时候由于不是NEW这个状态就会抛出<strong>IllegalThreadStateException</strong>这个异常了。</p> <p><img src="https://blog.maplestory.work/images/post_image/2020-08-06-Java线程不能重复Start.assets/1596882177407.png" alt="1596882177407" /></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RunTest</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I'm in the thread!"</span><span class="o">);</span>
        <span class="o">});</span>

        <span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">thread</span><span class="o">.</span><span class="na">getState</span><span class="o">());</span>

        <span class="n">thread</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">thread</span><span class="o">.</span><span class="na">getState</span><span class="o">());</span>
        <span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>
<span class="cm">/*
输出：
RUNNABLE
I'm in the thread!
I'm in the thread!
TERMINATED
Exception in thread "main" java.lang.IllegalThreadStateException
        at java.base/java.lang.Thread.start(Thread.java:794)
        at javatest.threadpool.RunTest.main(RunTest.java:26)
*/</span>
</code></pre></div></div> <p>但是一个线程对象可以调用多次run，因为他只是一个对象调用一个方法。但是run()方法并没有启动一个线程，只是在调用方法的线程中执行任务。事实上，应当调用thread.start()方法，因为这会创建一个执行run方法的新线程。</p> <h3 id="线程状态转换">线程状态转换</h3> <h5 id="javathreadstate-和-jvmtithreadstate-转换">JavaThreadState 和 JVMTIThreadState 转换</h5> <p><img src="https://blog.maplestory.work/images/post_image/2020-08-06-Java线程不能重复Start.assets/1596883974952.png" alt="1596883974952" /></p> <br> <nav class="pagination"> <a href="http://localhost:4000/Java%E8%B0%83%E7%94%A8Shell/" class="pagination_pager" title="Java调用Shell ">previous</a> <a href="http://localhost:4000/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" class="pagination_pager" title="工厂设计模式 ">next</a> </nav> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(http://localhost:4000/images/benjamin-deyoung-unsplash.jpg) center center no-repeat;"> <a href="https://github.com/Maple-Chan" target="_blank" rel="nofollow external"> <span> GitHub Home </span> </a> </li> </ul> </div> </body> </html>
