<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Fabric 常用命令 &#8211; Maple Story</title> <meta name="description" content="Stick to note down what I’v learnt"> <meta name="keywords" content="Hyperledger Fabric"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="halve.png"> <meta name="twitter:title" content="Fabric 常用命令"> <meta name="twitter:description" content="Stick to note down what I’v learnt"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Fabric 常用命令"> <meta property="og:description" content="Stick to note down what I’v learnt"> <meta property="og:url" content="http://localhost:4000/Fabric%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"> <meta property="og:site_name" content="Maple Story"> <meta property="og:image" content="http://localhost:4000/images/halve.png"> <link rel="canonical" href="http://localhost:4000/Fabric%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/home.jpg) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="http://localhost:4000" class="logo"><img src="http://localhost:4000/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Fabric 常用命令 </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#Hyperledger Fabric">Hyperledger Fabric</a></li> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">07 May 2020</div> <center><h2><b>Fabric 常用命令</b></h2></center> <p><br /></p> <h3 id="channel相关">channel相关</h3> <h4 id="获取某一channel区块信息">获取某一channel区块信息：</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer channel getinfo <span class="nt">-c</span> mychannel（区块的最新高度，hash值）
</code></pre></div></div> <h4 id="获取最新的区块">获取最新的区块</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer channel fetch newest <span class="nt">-c</span> mychannel channel-artifacts/new.pb <span class="nt">--orderer</span> orderer.example.com:7050 
</code></pre></div></div> <h4 id="获取最新的channel配置区块">获取最新的channel配置区块</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer channel fetch config <span class="nt">-c</span> mychannel channel-artifacts/config.pb <span class="nt">--orderer</span> orderer.example.com:7050
</code></pre></div></div> <h4 id="peer加入channel">peer加入channel</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer channel <span class="nb">join</span> <span class="nt">-b</span> ./mychannel.genesis.block
</code></pre></div></div> <h4 id="查看peer已经加入的channel">查看peer已经加入的channel</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer channel list
</code></pre></div></div> <h4 id="将pb区块转换为json">将pb区块转换为json</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>configtxlator proto_decode <span class="nt">--input</span> ./channel-artifacts/new.pb <span class="nt">--type</span> common.Block | jq <span class="nb">.</span> <span class="o">&gt;</span> ./channel-artifacts/new.json （将生成的区块转换成json格式）
</code></pre></div></div> <h4 id="创建channel">创建channel</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>configtxgen <span class="nt">-profile</span> TwoOrgsChannel <span class="nt">-outputCreateChannelTx</span> channel-artifacts/mychannel1.tx <span class="nt">-channelID</span> mychannel1

peer channel create <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">-c</span> mychannel1 <span class="nt">-f</span> ./channel-artifacts/mychannel1.tx <span class="nt">--tls</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem

peer channel <span class="nb">join</span> <span class="nt">-b</span> mychannel1.block

peer channel list
</code></pre></div></div> <h4 id="切换peer环境变量">切换peer环境变量</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org1MSP"</span>
<span class="nb">export </span><span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/tls/ca.crt
<span class="nb">export </span><span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
<span class="nb">export </span><span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer1.org1.example.com:7051
</code></pre></div></div> <h3 id="合约相关">合约相关</h3> <h4 id="安装合约">安装合约</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode <span class="nb">install</span> <span class="nt">-n</span> emr <span class="nt">-v</span> 1.0 <span class="nt">-p</span> github.com/chaincode/emr/

peer chaincode <span class="nb">install</span> <span class="nt">-n</span> javabasic <span class="nt">-l</span> java <span class="nt">-v</span> 5.0 <span class="nt">-p</span> /opt/gopath/src/github.com/chaincode/java/
</code></pre></div></div> <h4 id="实例化合约">实例化合约</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode instantiate <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">-C</span> mychannel <span class="nt">-n</span> emr <span class="nt">-v</span> 1.0 <span class="nt">-c</span> <span class="s1">'{"Args":["init"]}'</span> <span class="nt">-P</span> <span class="s2">"OR ('Org1MSP.peer')"</span>

<span class="c"># -P, --policy string  he endorsement policy associated to this chaincode</span>

peer chaincode instantiate <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">-C</span> mychannel <span class="nt">-n</span> javabasic <span class="nt">-v</span> 6.0 <span class="nt">-l</span> java <span class="nt">-c</span> <span class="s1">'{"Args":["init"]}'</span> <span class="nt">-P</span> <span class="s2">"OR ('Org1MSP.peer')"</span>
</code></pre></div></div> <h4 id="升级合约">升级合约</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode upgrade <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">-C</span> mychannel <span class="nt">-n</span> emr <span class="nt">-v</span> 2.0 <span class="nt">-c</span> <span class="s1">'{"Args":["init"]}'</span> <span class="nt">-P</span> <span class="s2">"OR ('Org1MSP.peer')"</span>
</code></pre></div></div> <h4 id="invoke合约">invoke合约</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode invoke <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nb">true</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">-C</span> mychannel <span class="nt">-n</span> basicinfo <span class="nt">--peerAddresses</span> peer0.org1.example.com:7051 <span class="nt">--tlsRootCertFiles</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt <span class="nt">-c</span> <span class="s1">'{"Args":["save","110115","{\"name\":\"zhangsan\",\"identity\":\"110115\",\"mobile\":\"18910012222\"}"]}'</span>


peer chaincode invoke <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nb">true</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">-C</span> mychannel <span class="nt">-n</span> javabasic <span class="nt">--peerAddresses</span> peer0.org1.example.com:7051 <span class="nt">--tlsRootCertFiles</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt <span class="nt">-c</span> <span class="s1">'{"Args":["invoke","110115","{\"name\":\"zhangsan\",\"identity\":\"110115\",\"mobile\":\"18910012222\"}"]}'</span>
</code></pre></div></div> <h4 id="查询合约">查询合约</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode query <span class="nt">-C</span> mychannel <span class="nt">-n</span> mycc <span class="nt">-c</span> <span class="s1">'{"Args":["query","a"]}'</span>

peer chaincode query <span class="nt">-C</span> mychannel <span class="nt">-n</span> javabasic <span class="nt">-c</span> <span class="s1">'{"Args":["query","110115"]}'</span>
</code></pre></div></div> <h4 id="查看已安装合约">查看已安装合约</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode list <span class="nt">--installed</span>
</code></pre></div></div> <h4 id="查看已经实例化合约">查看已经实例化合约</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer chaincode list <span class="nt">--instantiated</span> <span class="nt">-C</span> mychannel
</code></pre></div></div> <br> <nav class="pagination"> <a href="http://localhost:4000/Farbric-%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83/" class="pagination_pager" title="Fabric: 测试网络环境 ">previous</a> <a href="http://localhost:4000/FabricV2.0%E6%96%B0%E7%89%B9%E6%80%A7/" class="pagination_pager" title="新特性研究 ">next</a> </nav> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(http://localhost:4000/images/unsplash-image-4.jpg) center center no-repeat;"> <a href="https://blog.maplestory.work/classcheckin.html" target="_blank" rel="nofollow external"> <span> 点名小程序 </span> </a> </li> </ul> </div> </body> </html>
