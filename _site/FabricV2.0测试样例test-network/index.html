<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>FabricV2.0测试样例test-network &#8211; Maple Story</title> <meta name="description" content="Stick to note down what I’v learnt"> <meta name="keywords" content="Hyperledger Fabric"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="halve.png"> <meta name="twitter:title" content="FabricV2.0测试样例test-network"> <meta name="twitter:description" content="Stick to note down what I’v learnt"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="FabricV2.0测试样例test-network"> <meta property="og:description" content="Stick to note down what I’v learnt"> <meta property="og:url" content="http://localhost:4000/FabricV2.0%E6%B5%8B%E8%AF%95%E6%A0%B7%E4%BE%8Btest-network/"> <meta property="og:site_name" content="Maple Story"> <meta property="og:image" content="http://localhost:4000/images/halve.png"> <link rel="canonical" href="http://localhost:4000/FabricV2.0%E6%B5%8B%E8%AF%95%E6%A0%B7%E4%BE%8Btest-network/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/home.jpg) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="http://localhost:4000" class="logo"><img src="http://localhost:4000/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">FabricV2.0测试样例test-network </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#Hyperledger Fabric">Hyperledger Fabric</a></li> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">14 May 2020</div> <center><h2><b>FabricV2.0测试样例test-network</b></h2></center> <p><br /></p> <blockquote> <p>本文基于<a href="https://github.com/hyperledger/fabric-samples.git">fabric-samples</a>中的test-network测试网络</p> </blockquote> <h3 id="fabric-20-部分指令">Fabric 2.0 部分指令</h3> <blockquote> <p>基于test-network网络，clone fabric-sample ，进入test-work文件夹进行测试。</p> </blockquote> <h4 id="目录">目录</h4> <p><a href="#test-network使用">test-network使用</a></p> <p><a href="#通道创建和加入">通道创建和加入脚本解析</a></p> <p><a href="#新的链码管理">新的链码生命周期脚本解析</a></p> <p><a href="#隐私数据">隐私数据</a></p> <p><br /> <br /></p> <p><span id="test-network使用"> </span></p> <h5 id="test-network使用">test-network使用</h5> <blockquote> <p>Fabric的流程：生成证书、创世块，启动网络，创建创建通道，安装链码。</p> </blockquote> <h6 id="生成证书">生成证书</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cryptogen generate <span class="nt">--config</span><span class="o">=</span>./organizations/cryptogen/crypto-config-org1.yaml <span class="nt">--output</span><span class="o">=</span><span class="s2">"organizations"</span>  
<span class="c"># 使用crypton生成证书,也可以用CA生成。</span>
</code></pre></div></div> <p>生成区块</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>configtxgen <span class="nt">-profile</span> TwoOrgsOrdererGenesis <span class="nt">-channelID</span> system-channel <span class="nt">-outputBlock</span> ./system-genesis-block/genesis.block 
<span class="c"># 配置文件写在configtx.yaml</span>
</code></pre></div></div> <h6 id="网络启动">网络启动</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./network.sh up  <span class="c"># 启动test网络，默认使用leveldb状态数据库'-s couchdb'指定couchdb，cryptogen生成证书。</span>
</code></pre></div></div> <p>不用脚本就通过docker-compose启动各个容器。</p> <h6 id="创建channel">创建channel</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./network.sh createChannel <span class="c"># 创建默认通道 mychannel。 使用 -c channelname 进行指定</span>
<span class="c"># createChannel.sh脚本</span>
</code></pre></div></div> <p>使用<a href="#createChannel">创建通道脚本</a></p> <h6 id="安装链码">安装链码</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./network.sh deployCC <span class="c"># 安装智能合约，使用deployCC.sh脚本</span>
</code></pre></div></div> <p>使用<a href="#deployCC">链码部署脚本进行安装</a></p> <hr /> <p><br /> <br /></p> <p><span id="通道创建和加入"> </span></p> <h5 id="通道创建和加入">通道创建和加入</h5> <h6 id="创建channel-1">创建channel</h6> <blockquote> <p>创建channel脚本 scripts/createChannel.sh</p> </blockquote> <h6 id="创建通道tx文件">创建通道tx文件</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>configtxgen <span class="nt">-profile</span> TwoOrgsChannel <span class="nt">-outputCreateChannelTx</span> ./channel-artifacts/<span class="k">${</span><span class="nv">CHANNEL_NAME</span><span class="k">}</span>.tx <span class="nt">-channelID</span> <span class="nv">$CHANNEL_NAME</span>
<span class="c"># configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/sucChannel.tx -channelID sucChannel</span>

<span class="c"># configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/succhannel.tx -channelID succhannel</span>

<span class="c"># 创建suc_channel.tx，通道的tx文件</span>
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>configtxgen <span class="nt">-profile</span> TwoOrgsChannel <span class="nt">-outputAnchorPeersUpdate</span> ./channel-artifacts/<span class="k">${</span><span class="nv">orgmsp</span><span class="k">}</span>anchors.tx <span class="nt">-channelID</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-asOrg</span> <span class="k">${</span><span class="nv">orgmsp</span><span class="k">}</span>
<span class="c"># 创建锚节点的tx文件</span>
</code></pre></div></div> <h6 id="创建通道">创建通道</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
peer channel create <span class="nt">-o</span> localhost:7050 <span class="nt">-c</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">--ordererTLSHostnameOverride</span> orderer.example.com <span class="nt">-f</span> ./channel-artifacts/<span class="k">${</span><span class="nv">CHANNEL_NAME</span><span class="k">}</span>.tx <span class="nt">--outputBlock</span> ./channel-artifacts/<span class="k">${</span><span class="nv">CHANNEL_NAME</span><span class="k">}</span>.block <span class="nt">--tls</span> <span class="nv">$CORE_PEER_TLS_ENABLED</span> <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span>
<span class="c"># 创建channel，使用CA证书</span>

peer channel create <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">-c</span> succhannel <span class="nt">--ordererTLSHostnameOverride</span> orderer.example.com <span class="nt">-f</span> ./channel-artifacts/succhannel.tx <span class="nt">--outputBlock</span> ./channel-artifacts/succhannel.block <span class="nt">--tls</span> <span class="nb">true</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="o">&gt;</span>&amp;createChannel.log


<span class="c"># </span>


peer channel create <span class="nt">-o</span> localhost:7050 <span class="nt">-c</span> mychannel <span class="nt">-f</span> ./channel-artifacts/mychannel.tx <span class="nt">--outputBlock</span> ./channel-artifacts/mychannel.block
<span class="c"># 创建channel，使用TLS</span>
</code></pre></div></div> <h6 id="加入通道">加入通道</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer channel <span class="nb">join</span> <span class="nt">-b</span> ./channel-artifacts/succhannel.block <span class="o">&gt;</span>&amp;log.txt
<span class="c"># 需要先设置环境变量在进行加入通道</span>
</code></pre></div></div> <h6 id="更新锚节点">更新锚节点</h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer channel update <span class="nt">-o</span> localhost:7050 <span class="nt">--ordererTLSHostnameOverride</span> orderer.example.com <span class="nt">-c</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-f</span> ./channel-artifacts/<span class="k">${</span><span class="nv">CORE_PEER_LOCALMSPID</span><span class="k">}</span>anchors.tx <span class="o">&gt;</span>&amp;log.txt
<span class="c"># 更新锚节点，使用TLS</span>

peer channel update <span class="nt">-o</span> localhost:7050 <span class="nt">--ordererTLSHostnameOverride</span> orderer.example.com <span class="nt">-c</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">-f</span> ./channel-artifacts/<span class="k">${</span><span class="nv">CORE_PEER_LOCALMSPID</span><span class="k">}</span>anchors.tx <span class="nt">--tls</span> <span class="nv">$CORE_PEER_TLS_ENABLED</span> <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span>
<span class="c"># 更新锚节点，使用CA证书</span>
</code></pre></div></div> <hr /> <p><br /> <br /></p> <p><span id="新的链码管理"> </span></p> <h5 id="新的链码管理">新的链码管理</h5> <blockquote> <p>提出lifecycle指令对链码的部署进行管理</p> </blockquote> <p><strong>多个组织必须审批链码通过后，才能进行链码提交到帐本中</strong></p> <p>链码提交到账本的过程：打包、安装、审批、提交。（升级过程和安装启动过程一样）</p> <p><strong><a name="deployCC">链码部署</a></strong></p> <blockquote> <p>一键打包脚本 scripts/deployCC.sh</p> </blockquote> <h6 id="打包"><strong>打包</strong></h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer lifecycle chaincode package fabcar.tar.gz <span class="nt">--path</span> ../../fabric-samples/chaincode/fabcar/go/ <span class="nt">--lang</span> golang <span class="nt">--label</span> fabcar_1 <span class="o">&gt;</span>&amp;package.log
<span class="c">#peer lifecycle chaincode package fabcar.tar.gz --path ${CC_SRC_PATH} --lang ${CC_RUNTIME_LANGUAGE} --label fabcar_${VERSION} &gt;&amp;log.txt</span>

<span class="c"># 链码打包，将合约打包在了xxx.tar.gz文件中。</span>
</code></pre></div></div> <blockquote> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 出failed to normalize chaincode path: 'go list' 错误的解决办法</span>
go <span class="nb">env</span> <span class="nt">-w</span> <span class="nv">GO111MODULE</span><span class="o">=</span>on
go <span class="nb">env</span> <span class="nt">-w</span> <span class="nv">GOPROXY</span><span class="o">=</span>https://goproxy.cn,direct
</code></pre></div> </div> </blockquote> <h6 id="安装"><strong>安装</strong></h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer lifecycle chaincode <span class="nb">install </span>fabcar.tar.gz <span class="o">&gt;</span>&amp;log.txt
<span class="c"># 链码安装</span>
</code></pre></div></div> <h6 id="审批">审批</h6> <p>审批—配置链码定义</p> <blockquote> <p>定义包括名字，版本，包背书策略，签名策略，隐私数据配置等。</p> </blockquote> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer lifecycle chaincode approveformyorg <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--channelID</span> <span class="nv">$CHANNEL_NAME</span> <span class="nt">--name</span> fabcar <span class="nt">--version</span> <span class="k">${</span><span class="nv">VERSION</span><span class="k">}</span> <span class="nt">--init-required</span> <span class="nt">--package-id</span> <span class="k">${</span><span class="nv">PACKAGE_ID</span><span class="k">}</span> <span class="nt">--sequence</span> <span class="k">${</span><span class="nv">VERSION</span><span class="k">}</span> <span class="nt">--waitForEvent</span> <span class="o">&gt;</span>&amp;log.txt
<span class="c"># 2.0的指令，用于某个组织定义链码审批机制：</span>
<span class="nt">--signature-policy</span> <span class="s2">"OR('Org1MSP.member','Org2MSP.member')"</span> <span class="c"># 签名策略</span>
<span class="nt">--channel-config-policy</span> <span class="s2">"OR('Org1MSP.member','Org2MSP.member')"</span>   <span class="c"># 链码背书策略</span>

/<span class="k">*</span>
<span class="nb">export </span><span class="nv">ORDERER_CA</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem

<span class="nb">export </span><span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org1MSP"</span>
<span class="nb">export </span><span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
<span class="nb">export </span><span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
<span class="nb">export </span><span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org1.example.com:7051

peer lifecycle chaincode approveformyorg <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nb">true</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">--peerAddresses</span> peer0.org1.example.com:7051 <span class="nt">--tls</span> <span class="nb">true</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/tlscacerts/tls-localhost-7054-ca-org1.pem <span class="nt">--tlsRootCertFiles</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/fabric-ca/org1/tls-cert.pem <span class="nt">--channelID</span> succhannel <span class="nt">--name</span> fabcartest1 <span class="nt">--version</span> 1 <span class="nt">--init-required</span> <span class="nt">--package-id</span> fabcar_1:aca5cf806d53b8860e3bc4234af8fe9a017e7082d98108e07ffc7ea36dbc2e07 <span class="nt">--sequence</span> 1 <span class="nt">--signature-policy</span> <span class="s2">"OR('Org1MSP.member','Org2MSP.member')"</span> 

peer lifecycle chaincode approveformyorg <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--tls</span> <span class="nb">true</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">--tlsRootCertFiles</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/fabric-ca/org1/tls-cert.pem <span class="nt">--channelID</span> succhannel <span class="nt">--name</span> fabcartest1 <span class="nt">--version</span> 1 <span class="nt">--init-required</span> <span class="nt">--package-id</span> fabcar_1:aca5cf806d53b8860e3bc4234af8fe9a017e7082d98108e07ffc7ea36dbc2e07 <span class="nt">--sequence</span> 1 <span class="nt">--signature-policy</span> <span class="s2">"OR('Org1MSP.member','Org2MSP.member')"</span> 
<span class="c">#（二选一）--channel-config-policy Channel/Application/Admins  &gt;&amp;log.txt</span>

<span class="k">*</span>/


<span class="nb">export </span><span class="nv">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="s2">"Org2MSP"</span>
<span class="nb">export </span><span class="nv">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
<span class="nb">export </span><span class="nv">CORE_PEER_MSPCONFIGPATH</span><span class="o">=</span>/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp
<span class="nb">export </span><span class="nv">CORE_PEER_ADDRESS</span><span class="o">=</span>peer0.org2.example.com:9051
</code></pre></div></div> <p>审批—检查能否提交</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer lifecycle chaincode checkcommitreadiness <span class="nt">--channelID</span> succhannel <span class="nt">--name</span> fabcar <span class="nt">--version</span> 1 <span class="nt">--sequence</span> 1 <span class="nt">--output</span> json <span class="nt">--init-required</span> <span class="c">#&gt;&amp;log.txt</span>
<span class="c"># 2.0的指令，检查指定的链码是否可以向通道提交。</span>
</code></pre></div></div> <h6 id="提交"><strong>提交</strong></h6> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>peer lifecycle chaincode commit <span class="nt">-o</span> localhost:7050 <span class="nt">--channelID</span> mychannel1 <span class="nt">--name</span> fabcar <span class="nv">$PEER_CONN_PARMS</span> <span class="nt">--version</span> 1.0 <span class="nt">--sequence</span> 1 <span class="nt">--init-required</span> <span class="c">#&gt;&amp;log.txt</span>
<span class="c"># 2.0的指令，用于提交链码定义</span>

peer lifecycle chaincode commit <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--channelID</span> mychannel1 <span class="nt">--name</span> fabcar <span class="nt">--version</span> 1.0 <span class="nt">--sequence</span> 1 <span class="nt">--init-required</span> <span class="nt">--tls</span>  <span class="nt">--cafile</span> <span class="nv">$ORDERER_CA</span> <span class="nt">--peerAddresses</span> peer0.org1.example.com:7051

peer lifecycle chaincode commit <span class="nt">-o</span> orderer.example.com:7050 <span class="nt">--ordererTLSHostnameOverride</span> orderer.example.com <span class="nt">--tls</span> <span class="nb">true</span> <span class="nt">--cafile</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem <span class="nt">--channelID</span> mychannel1 <span class="nt">--name</span> fabcar1 <span class="nt">--peerAddresses</span> peer0.org1.example.com:7051 <span class="nt">--tlsRootCertFiles</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt <span class="nt">--peerAddresses</span> peer0.org2.example.com:9051 <span class="nt">--tlsRootCertFiles</span> /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt <span class="nt">--version</span> 1.0 <span class="nt">--sequence</span> 1 <span class="nt">--init-required</span>

</code></pre></div></div> <p><br /> <br /></p> <p><span id="隐私数据"> </span></p> <h5 id="隐私数据">隐私数据</h5> <p>隐私数据集合定义：</p> <blockquote> <p>一个集合定义包含了一个或者多个集合，每个集合具有一个策略列出了在集合中的所有组织，还包括用来控制在背书阶段私有数据的传播所使用的属性，另外还有一个可选项来决定数据是否会被删除。</p> </blockquote> <p>在2.0版本，隐私数据集合将由channel成员进行定义审批条件，<strong>当链码定义被提交到通道时部署隐私数据集合。</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--collections-config</span> 
<span class="c"># 在实例化，或者peer lifecycle chaincode approveformyorg 用这个标志来指定隐私数据集合配置文件路径</span>
</code></pre></div></div> <p>配置文件内容示意：</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
 </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collectionMarblePrivateDetails"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"policy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OR('Org1MSP.member')"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">私有数据集合分发策略</span><span class="w">
    </span><span class="nl">"requiredPeerCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//在节点为背书签名并将提案响应返回给客户端前，每个背书节点必须将私有数据分发到的节点(在被授权的组织当中)的最小数量。</span><span class="mi">0</span><span class="w"> </span><span class="err">表示不做分发要求</span><span class="w">
    </span><span class="nl">"maxPeerCount"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="err">//每个背书节点将会尝试将私有数据分发到的其他节点（在被授权的组织中)</span><span class="w"> </span><span class="err">的最大数量</span><span class="w">
    </span><span class="nl">"blockToLive"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="err">//代表了数据应该以区块的形式在私有数据库中存在多久。</span><span class="w">
    </span><span class="nl">"memberOnlyRead"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="err">//节点会自动强制只有属于这些集合的组织的客户端才可以读取私有数据。</span><span class="w">
    </span><span class="nl">"memberOnlyWrite"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="err">//节点会自动强制只有属于这些集合的组织的客户端才可以写入私有数据。</span><span class="w">
    </span><span class="nl">"endorsementPolicy"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">//可选背书策略，用于覆盖链码级的背书策略</span><span class="w">
     </span><span class="nl">"signaturePolicy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OR('Org1MSP.member')"</span><span class="w">  
    </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div> <p>API中隐私数据的存取</p> <div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PutPrivateData</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="p">)</span> 
<span class="n">GetPrivateData</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></div> <br> <nav class="pagination"> <a href="http://localhost:4000/SpringBoot%E6%B3%A8%E8%A7%A3/" class="pagination_pager" title="Spring Boot 注解 ">previous</a> <a href="http://localhost:4000/Fabric-CA(%E9%9D%9EDocker)%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/" class="pagination_pager" title="Fabric-CA(非Docker)使用说明 ">next</a> </nav> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(http://localhost:4000/images/unsplash-image-4.jpg) center center no-repeat;"> <a href="https://blog.maplestory.work/classcheckin.html" target="_blank" rel="nofollow external"> <span> 点名小程序 </span> </a> </li> </ul> </div> </body> </html>
